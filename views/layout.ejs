<!doctype html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title><%= title || (SHOP.name + ' POS') %></title>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <script src="/public/js/pos.js" defer></script>
    <script>
      // small helper to format IDR in client (fallback)
      window.formatIDR = (n) => new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', maximumFractionDigits: 0 }).format(n||0);
    </script>
    <script>
      (function () {
        const originalWarn = console.warn.bind(console);
        window.__restoreTailwindWarn__ = () => { console.warn = originalWarn; delete window.__restoreTailwindWarn__; };
        console.warn = function (...args) {
          if (args[0] && typeof args[0] === 'string' && args[0].includes('cdn.tailwindcss.com should not be used in production')) {
            return;
          }
          return originalWarn(...args);
        };
        window.tailwind = window.tailwind || {};
        window.tailwind.config = {
          theme: {
            extend: {
              colors: {
                brand: '#0F766E',
                brandAccent: '#D97706',
                brandSurface: '#F4DEC2',
                brandDeep: '#854D0E',
                brandSecondary: '#B45309'
              },
              fontFamily: {
                display: ['Poppins', 'ui-sans-serif', 'system-ui', '-apple-system', 'Segoe UI', 'Roboto', 'Arial', 'sans-serif']
              },
              boxShadow: {
                soft: '0 18px 40px -20px rgba(120,53,15,0.35)',
                glow: '0 20px 46px -22px rgba(15,118,110,0.45)'
              },
              keyframes: {
                float: {
                  '0%,100%': { transform: 'translateY(0)' },
                  '50%': { transform: 'translateY(-4px)' }
                },
                fadeIn: {
                  '0%': { opacity: 0, transform: 'translateY(12px)' },
                  '100%': { opacity: 1, transform: 'translateY(0)' }
                }
              },
              animation: {
                float: 'float 6s ease-in-out infinite',
                'fade-in': 'fadeIn 0.5s ease-out forwards'
              }
            }
          }
        };
      })();
    </script>
    <script src="https://cdn.tailwindcss.com" onload="window.__restoreTailwindWarn__ && window.__restoreTailwindWarn__();"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
        <style>
      [x-cloak] { display: none !important; }
      .custom-scroll::-webkit-scrollbar { width: 8px; }
      .custom-scroll::-webkit-scrollbar-track { background: transparent; }
      .custom-scroll::-webkit-scrollbar-thumb {
        background-color: rgba(15,118,110,0.35);
        border-radius: 9999px;
      }
      .custom-scroll { scrollbar-width: thin; scrollbar-color: rgba(15,118,110,0.35) transparent; }

      :root {
        --surface-body: #f5f0e4;
        --surface-card: #fffdf7;
        --surface-muted: #f2e7d3;
        --surface-hover: #e8dcc3;
        --border-soft: rgba(120,53,15,0.15);
        --border-strong: rgba(120,53,15,0.25);
        --brand-primary: #0f766e;
        --brand-primary-strong: #0b5c56;
        --accent-warm: #d97706;
        --accent-warm-strong: #b45309;
        --status-success: #16a34a;
        --status-warning: #eab308;
        --status-danger: #dc2626;
        --text-strong: #3b2f2f;
        --text-base: #4a3b35;
        --text-muted: #6b5a4d;
        --text-subtle: #8c7a6e;
        --text-inverse: #ffffff;
        --shadow-soft: 0 18px 36px -18px rgba(120,53,15,0.35);
      }

      body {
        background: var(--surface-body);
        color: var(--text-base);
        position: relative;
        padding-top: 6.5rem;
      }

      body::before {
        content: "";
        position: fixed;
        inset: 0;
        pointer-events: none;
        background:
          radial-gradient(circle at 25% 18%, rgba(217,119,6,0.08), transparent 58%),
          radial-gradient(circle at 80% 72%, rgba(15,118,110,0.08), transparent 55%),
          repeating-linear-gradient(0deg, rgba(107,83,48,0.05), rgba(107,83,48,0.05) 1px, transparent 1px, transparent 18px),
          repeating-linear-gradient(90deg, rgba(107,83,48,0.04), rgba(107,83,48,0.04) 1px, transparent 1px, transparent 18px);
        opacity: 0.8;
        z-index: -1;
      }

      a {
        color: var(--brand-primary-strong);
      }

      a:hover {
        color: var(--accent-warm-strong);
      }

      .text-strong { color: var(--text-strong) !important; }
      .text-base { color: var(--text-base) !important; }
      .text-muted { color: var(--text-muted) !important; }
      .text-subtle { color: var(--text-subtle) !important; }
      .text-accent { color: var(--brand-primary) !important; }

      .glass-card {
        background: var(--surface-card);
        border: 1px solid var(--border-soft);
        border-radius: 1.5rem;
        box-shadow: var(--shadow-soft);
      }

      .glass-card h1,
      .glass-card h2,
      .glass-card h3,
      .glass-card h4,
      .glass-card h5,
      .glass-card h6 {
        color: var(--text-strong);
      }

      .glass-card p,
      .glass-card span,
      .glass-card label {
        color: var(--text-base);
      }

      .glass-card small,
      .glass-card .text-muted,
      .glass-card .muted {
        color: var(--text-muted);
      }

      .glass-input,
      .glass-card input,
      .glass-card select,
      .glass-card textarea {
        background: var(--surface-muted);
        border: 1px solid var(--border-soft);
        color: var(--text-base);
        border-radius: 0.75rem;
        transition: box-shadow 0.2s ease, border-color 0.2s ease;
      }

      .glass-card input::placeholder,
      .glass-card textarea::placeholder {
        color: var(--text-subtle);
      }

      .glass-card input:focus,
      .glass-card select:focus,
      .glass-card textarea:focus {
        border-color: var(--brand-primary);
        box-shadow: 0 0 0 3px rgba(15,118,110,0.2);
        outline: none;
      }

      .glass-button,
      .glass-card button,
      .glass-card .button-like {
        background: var(--brand-primary);
        border: 1px solid var(--brand-primary);
        color: var(--text-inverse);
        border-radius: 9999px;
        box-shadow: 0 14px 28px -16px rgba(15,118,110,0.45);
        transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
      }

      .glass-button:hover,
      .glass-card button:hover,
      .glass-card .button-like:hover {
        background: var(--brand-primary-strong);
        border-color: var(--brand-primary-strong);
        transform: translateY(-1px);
        box-shadow: 0 18px 34px -18px rgba(11,92,86,0.5);
      }

      .glass-button.alt,
      .glass-card .button-like.alt {
        background: var(--accent-warm);
        border-color: var(--accent-warm);
        box-shadow: 0 14px 28px -16px rgba(217,119,6,0.4);
      }

      .glass-button.alt:hover,
      .glass-card .button-like.alt:hover {
        background: var(--accent-warm-strong);
        border-color: var(--accent-warm-strong);
        box-shadow: 0 18px 34px -18px rgba(180,83,9,0.45);
      }

      .glass-table table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
      }

      .glass-table thead th {
        background: var(--surface-muted) !important;
        color: var(--text-subtle) !important;
        border-bottom: 1px solid var(--border-soft) !important;
      }

      .glass-table tbody tr {
        background: var(--surface-card) !important;
        color: var(--text-base) !important;
        border-bottom: 1px solid var(--border-soft) !important;
        transition: background 0.2s ease;
      }

      .glass-table tbody tr:nth-child(even) {
        background: #f9f1dd !important;
      }

      .glass-table tbody tr:hover {
        background: var(--surface-hover) !important;
      }

      .glass-table th.kasir-cell,
      .glass-table td.kasir-cell {
        color: var(--text-strong) !important;
      }

      .badge-glass {
        display: inline-flex;
        align-items: center;
        gap: 0.25rem;
        background: var(--surface-muted) !important;
        border: 1px solid var(--border-soft) !important;
        color: var(--text-muted) !important;
        border-radius: 9999px;
        padding: 0.2rem 0.75rem;
        font-weight: 600;
      }

      .badge-glass.positive {
        color: var(--status-success) !important;
        border-color: rgba(22,163,74,0.28) !important;
        background: rgba(22,163,74,0.12) !important;
      }

      .badge-glass.warning {
        color: var(--status-warning) !important;
        border-color: rgba(234,179,8,0.32) !important;
        background: rgba(234,179,8,0.14) !important;
      }

      .badge-glass.danger {
        color: var(--status-danger) !important;
        border-color: rgba(220,38,38,0.32) !important;
        background: rgba(220,38,38,0.14) !important;
      }

      .chip-glass {
        background: var(--surface-muted) !important;
        border: 1px solid var(--border-soft) !important;
        color: var(--text-muted) !important;
        border-radius: 0.9rem;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        padding: 0.4rem 0.95rem;
      }

      .glass-card input[type="checkbox"],
      .glass-card input[type="radio"] {
        accent-color: var(--brand-primary);
      }

      .navbar {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 30;
        background: rgba(255, 251, 244, 0.97);
        border-bottom: 1px solid var(--border-soft);
        box-shadow: 0 16px 32px -24px rgba(120,53,15,0.35);
        backdrop-filter: blur(12px);
        padding: 0.85rem 1.5rem;
      }

      .nav-inner {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 1.5rem;
        flex-wrap: wrap;
      }

      .nav-link {
        color: var(--text-muted);
        border-radius: 999px;
        transition: background 0.2s ease, color 0.2s ease;
        padding: 0.35rem 0.9rem;
      }

      .nav-link:hover {
        background: rgba(217,119,6,0.12);
        color: var(--text-strong);
      }

      .nav-link.active {
        background: rgba(15,118,110,0.15);
        color: var(--brand-primary-strong);
      }
    </style>
  </head>
  <body class="min-h-screen font-display">
    <nav class="navbar">
      <div class="nav-inner max-w-6xl mx-auto">
        <div class="flex items-center gap-3">
          <span class="inline-flex h-10 w-10 items-center justify-center rounded-xl bg-brand/20 text-brand font-semibold shadow-soft">
            KW
          </span>
          <div>
            <p class="text-xs uppercase tracking-wider text-subtle">Warung Sembako</p>
            <p class="text-lg font-semibold text-strong"><%= SHOP.name %></p>
          </div>
        </div>
        <div class="flex items-center gap-3 text-sm">
        <% if (currentUser) { %>
          <a href="/pos" class="nav-link <%= title === 'Kasir' ? 'active' : '' %>">Kasir</a>
          <a href="/orders" class="nav-link <%= title === 'Orders' ? 'active' : '' %>">Orders</a>
          <a href="/reports/daily" class="nav-link <%= title === 'Laporan' ? 'active' : '' %>">Laporan</a>
          <a href="/products" class="nav-link <%= title === 'Produk' ? 'active' : '' %>">Produk</a>
          <span class="text-base text-muted">Hi, <span class="font-semibold text-strong"><%= currentUser.username %></span></span>
          <a href="/logout" class="glass-button px-4 py-2 text-sm">Logout</a>
        <% } else { %>
          <a href="/login" class="glass-button px-4 py-2 text-sm">Login</a>
        <% } %>
        </div>
      </div>
    </nav>
    <main class="max-w-5xl mx-auto px-8 sm:px-14 lg:px-24 pt-8 pb-12">
      <div class="animate-fade-in space-y-8">
        <%= body %>
      </div>
    </main>
  </body>
</html>

